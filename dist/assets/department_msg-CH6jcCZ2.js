import{u as N,g as B,a as R,b as T,c as H}from"./message-BCHN95fF.js";import{u as U}from"./message-Dj9p4ND2.js";import{d as j,r as v,a as z,j as g,w as t,e as i,o as d,b as a,f as l,h as u,x as A,t as _,k as h,g as b,c as x,_ as E}from"./index-C-sImJSJ.js";const F={class:"message-list-wrapped"},J={class:"list-table-content"},O={class:"title-wrapped"},q={class:"title"},G={key:0,class:"detail-wrapped"},K=["innerHTML"],P={key:1,class:"detail-wrapped"},Q=j({__name:"department_msg",setup(W,{expose:S}){const c=N(),y=v([]),r=z({message_title:"",message_content:""}),p=v([]),k=async()=>{const s=localStorage.getItem("id"),n=localStorage.getItem("department");if(n!==null){const o=await B(s);if(y.value=await R(n),o[0].read_status==0){const{read_list:m}=await T(s,n);p.value=m}else p.value=JSON.parse(o[0].read_list)}};k();const V=async s=>{await U(s.message_click_number,s.id),await H(localStorage.getItem("id"),s.id),r.message_title=s.message_title,r.message_content=s.message_content,k(),c.returnReadList(localStorage.getItem("id"))},f=v(!1);return S({open:()=>{f.value=!0}}),(s,n)=>{const o=i("el-table-column"),m=i("el-tag"),C=i("el-table"),L=i("el-aside"),M=i("el-main"),D=i("el-container"),I=i("el-dialog");return d(),g(I,{modelValue:f.value,"onUpdate:modelValue":n[0]||(n[0]=e=>f.value=e),title:"部门消息",width:"40%",center:"",draggable:"","destroy-on-close":""},{default:t(()=>[a(D,null,{default:t(()=>[a(L,{width:"416px"},{default:t(()=>[l("div",F,[l("div",J,[a(C,{data:u(c).msg_list.length>0?u(c).msg_list:y.value,style:{width:"100%",cursor:"pointer"},"highlight-current-row":"",onRowClick:V},{default:t(()=>[a(o,{type:"index",width:"50"}),a(o,{width:"10"},{default:t(({row:e})=>[l("div",{class:A((u(c).read_list.length>0?u(c).read_list:p.value).includes(e.id)?"noread":"readed")},null,2)]),_:1}),a(o,{prop:"message_title",label:"主题"},{default:t(({row:e})=>[l("div",O,[l("div",q,_(e.message_title),1)])]),_:1}),a(o,{prop:"message_level",label:"等级"},{default:t(({row:e})=>[e.message_level=="一般"?(d(),g(m,{key:0,effect:"light",type:"primary",round:""},{default:t(()=>[b(_(e.message_level),1)]),_:2},1024)):h("",!0),e.message_level=="重要"?(d(),g(m,{key:1,effect:"light",type:"warning",round:""},{default:t(()=>[b(_(e.message_level),1)]),_:2},1024)):h("",!0),e.message_level=="紧急"?(d(),g(m,{key:2,effect:"light",type:"danger",round:""},{default:t(()=>[b(_(e.message_level),1)]),_:2},1024)):h("",!0)]),_:1}),a(o,{prop:"message_publish_time",label:"发布时间"},{default:t(({row:e})=>{var w;return[l("div",null,_((w=e.message_publish_time)==null?void 0:w.slice(0,10)),1)]}),_:1})]),_:1},8,["data"])])])]),_:1}),a(M,null,{default:t(()=>[r.message_title!==""?(d(),x("div",G,[l("div",null,_(r.message_title),1),l("div",{innerHTML:r.message_content},null,8,K)])):(d(),x("div",P,n[1]||(n[1]=[l("div",null,"请点击左侧列表中的消息查看",-1)])))]),_:1})]),_:1})]),_:1},8,["modelValue"])}}}),ee=E(Q,[["__scopeId","data-v-fa32683b"]]);export{ee as o};
