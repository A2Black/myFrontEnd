import{d as G,r as u,a as h,j as V,w as l,e as f,o as m,b as o,f as s,g as p,u as we,E as n,s as ye,i as ae,h as c,c as S,F as K,p as be,l as H,m as ne,t as j,n as z,q as re,_ as Ve}from"./index-DAzvbAht.js";import{b as Ce}from"./bread_crumb-BVsCHufp.js";import{u as Pe}from"./userinfo-DTtnKP-y.js";import{g as A,c as ke,d as xe,a as Ue,e as Ie,f as Se,h as Ne,s as ie,i as ue}from"./setting-COqKDi4v.js";import{c as De,b as $e,a as Fe,d as Be,e as Ee}from"./userinfor-5i_LEdTx.js";import{T as Te,E as Oe}from"./index.esm-Dtw38fWr.js";import{b as W}from"./mitt-CdlF-dbX.js";import"./SvgIcon-CrgHh77p.js";import"./index-Cyc5mHF5.js";const Re="/assets/logo-CPmPqqKk.png",he={class:"dialog-footer"},qe=G({__name:"change_password",setup(Q,{expose:r}){const y=we(),C=u("top"),_=h({oldPassword:"",newPassword:""}),v=h({changePasswordDialog:!1});r({open:()=>{v.changePasswordDialog=!0}});const N=async()=>{_.oldPassword&&_.newPassword?(await De(localStorage.getItem("id"),_.oldPassword,_.newPassword)).status==0?(n({message:"密码修改成功！",type:"success"}),v.changePasswordDialog=!1,y.replace("/login")):n.error("密码修改失败,请重新输入"):n.error("请检查输入的密码是否正确")},B=h({oldPassword:[{required:!0,message:"请输入您的旧密码",trigger:"blur"}],newPassword:[{required:!0,message:"请输入您的新密码",trigger:"blur"}]});return(E,i)=>{const D=f("el-input"),P=f("el-form-item"),d=f("el-form"),g=f("el-button"),x=f("el-dialog");return m(),V(x,{modelValue:v.changePasswordDialog,"onUpdate:modelValue":i[3]||(i[3]=w=>v.changePasswordDialog=w),title:"修改密码",width:"500"},{footer:l(()=>[s("div",he,[o(g,{onClick:i[2]||(i[2]=w=>v.changePasswordDialog=!1)},{default:l(()=>i[4]||(i[4]=[p("取消")])),_:1}),o(g,{type:"primary",onClick:N},{default:l(()=>i[5]||(i[5]=[p(" 确认 ")])),_:1})])]),default:l(()=>[o(d,{class:"login-form","label-width":"auto",style:{"max-width":"400px"},"label-position":C.value,rules:B},{default:l(()=>[o(P,{label:"请输入你的旧密码",prop:"oldPassword"},{default:l(()=>[o(D,{modelValue:_.oldPassword,"onUpdate:modelValue":i[0]||(i[0]=w=>_.oldPassword=w),placeholder:"请输入你的旧密码","show-password":"",autocomplete:"new-password"},null,8,["modelValue"])]),_:1}),o(P,{label:"请输入你的新密码",prop:"newPassword"},{default:l(()=>[o(D,{modelValue:_.newPassword,"onUpdate:modelValue":i[1]||(i[1]=w=>_.newPassword=w),placeholder:"请输入你的新密码","show-password":""},null,8,["modelValue"])]),_:1})]),_:1},8,["label-position","rules"])]),_:1},8,["modelValue"])}}}),Ke={style:{border:"1px solid #ccc"}},ze={class:"dialog-footer"},Ae=G({__name:"editor",setup(Q,{expose:r}){const y=u();W.on("editorTitle",async d=>{d==1&&(y.value="编辑公司介绍",v.value=await A("公司介绍")),d==2&&(y.value="编辑公司架构",v.value=await A("公司架构")),d==3&&(y.value="编辑公司战略",v.value=await A("公司战略")),d==4&&(y.value="公司高层",v.value=await A("公司高层"))});const C=ye(),_=u("default"),v=u(),F={excludeKeys:[]},N={placeholder:"请输入内容...",MENU_CONF:{uploadImage:{server:"http://127.0.0.1:3007/set/uploadCompanyPicture",fieldName:"file",methods:"post",metaWithUrl:!0,customInsert(d,g){g(d.url)}}}};F.excludeKeys=["blockquote","bgColor","color","group-more-style","bulletedList","numberedList","lineHeight","todo","insertLink","group-video","insertTable","codeBlock","divider","fullScreen"];const B=async()=>{console.log(y.value.slice(-4));const d=await ke(v.value,y.value.slice(-4));console.log(d),d.status==0?(n({message:"修改公司介绍成功！",type:"success"}),i.dialogFormVisible=!1):(i.dialogFormVisible=!1,n.error("修改公司介绍失败，请检查网络是否通畅！"))};ae(()=>{const d=C.value;d!=null&&d.destroy()});const E=d=>{C.value=d},i=h({dialogFormVisible:!1}),D=()=>{n.error("取消赋权！"),i.dialogFormVisible=!1};return r({open:()=>{i.dialogFormVisible=!0}}),ae(()=>{W.all.clear()}),(d,g)=>{const x=f("el-button"),w=f("el-dialog");return m(),V(w,{modelValue:i.dialogFormVisible,"onUpdate:modelValue":g[1]||(g[1]=T=>i.dialogFormVisible=T),title:y.value,width:"600px","destroy-on-close":""},{footer:l(()=>[s("span",ze,[o(x,{onClick:D},{default:l(()=>g[2]||(g[2]=[p("取消")])),_:1}),o(x,{type:"primary",onClick:B},{default:l(()=>g[3]||(g[3]=[p(" 确认 ")])),_:1})])]),default:l(()=>[s("div",Ke,[o(c(Te),{style:{"border-bottom":"1px solid #ccc"},editor:C.value,defaultConfig:F,mode:_.value},null,8,["editor","mode"]),o(c(Oe),{style:{height:"500px","overflow-y":"hidden"},modelValue:v.value,"onUpdate:modelValue":g[0]||(g[0]=T=>v.value=T),defaultConfig:N,mode:_.value,onOnCreated:E},null,8,["modelValue","mode"])])]),_:1},8,["modelValue","title"])}}}),Je={class:"common-wrapped"},Le={class:"common-content"},Me={class:"account-infor-wrapped"},He={class:"account-infor-content"},je=["src"],We={class:"account-infor-wrapped"},Ge={class:"account-infor-content"},Qe={class:"account-infor-wrapped"},Xe={class:"account-infor-content"},Ye={class:"account-infor-wrapped"},Ze={class:"account-infor-content"},es={class:"account-save-button"},ss={class:"account-infor-wrapped"},os={class:"account-infor-content"},ts={class:"account-save-button"},ls={class:"account-infor-wrapped"},as={class:"account-infor-content"},ns={class:"account-infor-wrapped"},rs={class:"account-infor-content"},is={class:"account-infor-wrapped"},us={class:"account-infor-content"},ds={class:"account-save-button"},cs={class:"account-infor-wrapped"},ps={class:"account-infor-content"},ms={class:"account-save-button"},fs={class:"account-infor-wrapped"},vs={class:"account-infor-content"},gs={class:"account-infor-wrapped"},_s={class:"account-infor-content"},ws={class:"account-infor-wrapped"},ys={class:"account-infor-content"},bs={class:"account-infor-wrapped"},Vs={class:"account-infor-content"},Cs={class:"home-wrapped"},Ps={class:"swiper-name"},ks=["src"],xs={key:1,src:Re,alt:""},Us={class:"other-set"},Is={class:"department-set"},Ss={class:"flex gap-2"},Ns={class:"product-set"},Ds={class:"flex gap-2"},$s=G({__name:"index",setup(Q){const r=Pe(),y=u(),C=u("first"),_=u(),v=u({first:"系统设置"}),F=a=>{a.status==0?(r.$patch({imageUrl:a.url}),n({message:"头像更新成功！",type:"success"}),(async()=>await $e(r.account,a.onlyId,a.url))()):n.error("头像更新失败!请重新上传")},N=a=>a.size/1024/1024>6?(n.error("头像大小请不要超过6MB!"),!1):!0;h({account:"",name:"",sex:"",identity:"",department:"",email:""});const B=()=>{y.value.open()},E=async()=>{const a=await Fe(localStorage.getItem("id"),r.name);console.log(a),a.status==0?n({message:"修改成功！",type:"success"}):n.error("修改失败,请重新输入")},i=async()=>{const a=await Be(localStorage.getItem("id"),r.sex);console.log(a),a.status==0?n({message:"修改成功！",type:"success"}):n.error("修改失败,请重新输入")},D=async()=>{const a=await Ee(localStorage.getItem("id"),r.email);console.log(a),a.status==0?n({message:"修改成功！",type:"success"}):n.error("修改失败,请重新输入")},P=u();(async()=>{P.value=await xe()})();const g=async()=>{(await Ne(P.value)).status==0?n({message:"修改成功！",type:"success"}):n.error("修改失败,请重新输入!")},x=u(),w=a=>{W.emit("editorTitle",a),x.value.open()},T=[{name:"swiper1"},{name:"swiper2"},{name:"swiper3"},{name:"swiper4"},{name:"swiper5"}],de=a=>{X()},J=u([]),X=async()=>{const a=await Ue();J.value=a};X();const O=u(""),U=u([]),L=u(!1),Y=u(),R=u(""),I=u([]),M=u(!1),Z=u();(async()=>{U.value=await Ie()})(),(async()=>{I.value=await Se()})();const ce=async a=>{U.value.splice(U.value.indexOf(a),1),(await ie(JSON.stringify(z(U.value)))).status==0?n({message:"删除部门成功！",type:"success"}):n.error("删除部门失败!")},pe=async a=>{I.value.splice(I.value.indexOf(a),1),(await ue(JSON.stringify(z(I.value)))).status==0?n({message:"删除产品类别成功！",type:"success"}):n.error("删除产品类别失败!")},me=()=>{L.value=!0,re(()=>{Y.value.input.focus()})},fe=()=>{M.value=!0,re(()=>{Z.value.input.focus()})},ee=async()=>{O.value&&(U.value.push(O.value),(await ie(JSON.stringify(z(U.value)))).status==0?n({message:"添加部门成功！",type:"success"}):n.error("添加部门失败,请重新输入!")),L.value=!1,O.value=""},se=async()=>{R.value&&(I.value.push(R.value),(await ue(JSON.stringify(z(I.value)))).status==0?n({message:"添加产品类别成功！",type:"success"}):n.error("添加产品类别失败,请重新输入!")),M.value=!1,R.value=""};return(a,e)=>{const ve=f("el-icon"),oe=f("el-upload"),k=f("el-input"),b=f("el-button"),te=f("el-option"),ge=f("el-select"),q=f("el-tab-pane"),le=f("el-tag"),_e=f("el-tabs");return m(),S(K,null,[s("div",Je,[o(Ce,{ref_key:"breadcrumb",ref:_,item:v.value},null,8,["item"]),s("div",Le,[o(_e,{modelValue:C.value,"onUpdate:modelValue":e[13]||(e[13]=t=>C.value=t),class:"demo-tabs",stretch:"true"},{default:l(()=>[o(q,{label:"账号详情",name:"first"},{default:l(()=>[s("div",Me,[e[14]||(e[14]=s("span",null,"头像：",-1)),s("div",He,[o(oe,{class:"avatar-uploader",action:"http://127.0.0.1:3007/user/uploadAvatar","show-file-list":!1,"on-success":F,"before-upload":N},{default:l(()=>[c(r).imageUrl?(m(),S("img",{key:0,src:c(r).imageUrl,class:"avatar"},null,8,je)):(m(),V(ve,{key:1,class:"avatar-uploader-icon"},{default:l(()=>[o(c(be))]),_:1}))]),_:1})])]),s("div",We,[e[15]||(e[15]=s("span",null,"账号：",-1)),s("div",Ge,[o(k,{modelValue:c(r).account,"onUpdate:modelValue":e[0]||(e[0]=t=>c(r).account=t),disabled:""},null,8,["modelValue"])])]),s("div",Qe,[e[17]||(e[17]=s("span",null,"密码：",-1)),s("div",Xe,[o(b,{type:"primary",onClick:B},{default:l(()=>e[16]||(e[16]=[p("修改密码")])),_:1})])]),s("div",Ye,[e[19]||(e[19]=s("span",null,"姓名：",-1)),s("div",Ze,[o(k,{modelValue:c(r).name,"onUpdate:modelValue":e[1]||(e[1]=t=>c(r).name=t)},null,8,["modelValue"])]),s("div",es,[o(b,{type:"primary",onClick:E},{default:l(()=>e[18]||(e[18]=[p("保存")])),_:1})])]),s("div",ss,[e[21]||(e[21]=s("span",null,"性别：",-1)),s("div",os,[o(ge,{modelValue:c(r).sex,"onUpdate:modelValue":e[2]||(e[2]=t=>c(r).sex=t)},{default:l(()=>[o(te,{label:"男",value:"男"}),o(te,{label:"女",value:"女"})]),_:1},8,["modelValue"])]),s("div",ts,[o(b,{type:"primary",onClick:i},{default:l(()=>e[20]||(e[20]=[p("保存")])),_:1})])]),s("div",ls,[e[22]||(e[22]=s("span",null,"身份：",-1)),s("div",as,[o(k,{modelValue:c(r).identity,"onUpdate:modelValue":e[3]||(e[3]=t=>c(r).identity=t),disabled:""},null,8,["modelValue"])])]),s("div",ns,[e[23]||(e[23]=s("span",null,"部门：",-1)),s("div",rs,[o(k,{modelValue:c(r).department,"onUpdate:modelValue":e[4]||(e[4]=t=>c(r).department=t),disabled:""},null,8,["modelValue"])])]),s("div",is,[e[25]||(e[25]=s("span",null,"邮箱：",-1)),s("div",us,[o(k,{modelValue:c(r).email,"onUpdate:modelValue":e[5]||(e[5]=t=>c(r).email=t)},null,8,["modelValue"])]),s("div",ds,[o(b,{type:"primary",onClick:D},{default:l(()=>e[24]||(e[24]=[p("保存")])),_:1})])])]),_:1}),o(q,{label:"公司信息",name:"second"},{default:l(()=>[s("div",cs,[e[27]||(e[27]=s("span",null,"公司名称：",-1)),s("div",ps,[o(k,{modelValue:P.value,"onUpdate:modelValue":e[6]||(e[6]=t=>P.value=t)},null,8,["modelValue"])]),s("div",ms,[o(b,{type:"primary",onClick:g},{default:l(()=>e[26]||(e[26]=[p("编辑公司名称")])),_:1})])]),s("div",fs,[e[29]||(e[29]=s("span",null,"公司介绍：",-1)),s("div",vs,[o(b,{type:"primary",onClick:e[7]||(e[7]=t=>w(1))},{default:l(()=>e[28]||(e[28]=[p("编辑公司介绍")])),_:1})])]),s("div",gs,[e[31]||(e[31]=s("span",null,"公司架构：",-1)),s("div",_s,[o(b,{type:"primary",onClick:e[8]||(e[8]=t=>w(2))},{default:l(()=>e[30]||(e[30]=[p("编辑公司架构")])),_:1})])]),s("div",ws,[e[33]||(e[33]=s("span",null,"公司战略：",-1)),s("div",ys,[o(b,{type:"primary",onClick:e[9]||(e[9]=t=>w(3))},{default:l(()=>e[32]||(e[32]=[p("编辑公司战略")])),_:1})])]),s("div",bs,[e[35]||(e[35]=s("span",null,"公司高层：",-1)),s("div",Vs,[o(b,{type:"primary",onClick:e[10]||(e[10]=t=>w(4))},{default:l(()=>e[34]||(e[34]=[p("编辑公司高层")])),_:1})])])]),_:1}),o(q,{label:"首页管理",name:"third"},{default:l(()=>[s("div",Cs,[e[36]||(e[36]=s("div",{class:"tips"},[s("span",null,"提示：点击图片框进行切换首页轮播图")],-1)),(m(),S(K,null,H(T,(t,$)=>s("div",{class:"swiper-wrapped",key:$},[s("div",Ps,"轮播图"+j($+1)+":  ",1),o(oe,{class:"avatar-uploader",action:"http://127.0.0.1:3007/set/uploadSwiper","show-file-list":!1,"on-success":de,"before-upload":N,data:t},{trigger:l(()=>[J.value[$]?(m(),S("img",{key:0,src:J.value[$],class:"swiper"},null,8,ks)):(m(),S("img",xs))]),_:2},1032,["data"])])),64))])]),_:1}),o(q,{label:"其他设置",name:"fourth"},{default:l(()=>[s("div",Us,[s("div",Is,[e[38]||(e[38]=s("span",null,"部门设置:",-1)),s("div",Ss,[(m(!0),S(K,null,H(U.value,t=>(m(),V(le,{key:t,size:"large",closable:"","disable-transitions":!1,onClose:$=>ce(t)},{default:l(()=>[p(j(t),1)]),_:2},1032,["onClose"]))),128)),L.value?(m(),V(k,{key:0,ref_key:"InputRef",ref:Y,modelValue:O.value,"onUpdate:modelValue":e[11]||(e[11]=t=>O.value=t),class:"w-20",size:"small",onKeyup:ne(ee,["enter"]),onBlur:ee},null,8,["modelValue"])):(m(),V(b,{key:1,class:"button-new-tag",onClick:me},{default:l(()=>e[37]||(e[37]=[p(" +添加新部门 ")])),_:1}))])]),s("div",Ns,[e[40]||(e[40]=s("span",null,"产品设置:",-1)),s("div",Ds,[(m(!0),S(K,null,H(I.value,t=>(m(),V(le,{key:t,closable:"",size:"large","disable-transitions":!1,onClose:$=>pe(t)},{default:l(()=>[p(j(t),1)]),_:2},1032,["onClose"]))),128)),M.value?(m(),V(k,{key:0,ref_key:"InputProductRef",ref:Z,modelValue:R.value,"onUpdate:modelValue":e[12]||(e[12]=t=>R.value=t),class:"w-20",size:"small",onKeyup:ne(se,["enter"]),onBlur:se},null,8,["modelValue"])):(m(),V(b,{key:1,class:"button-new-tag",onClick:fe},{default:l(()=>e[39]||(e[39]=[p(" +添加新产品类别 ")])),_:1}))])])])]),_:1})]),_:1},8,["modelValue"])])]),o(qe,{ref_key:"changeP",ref:y},null,512),o(Ae,{ref_key:"editorP",ref:x},null,512)],64)}}}),Js=Ve($s,[["__scopeId","data-v-2b5ed747"]]);export{Js as default};
